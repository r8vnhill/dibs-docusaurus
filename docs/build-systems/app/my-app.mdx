---
title: Mi primera aplicaci贸n
---
import { LanguageCard } from "../../../src/components/cards/LanguageCard";
import References from "../../../src/components/ReferencesComponent";
import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import ReadingTime from "../../../src/components/ReadingTime";

<ReadingTime/>

En esta secci贸n, aprenderemos a crear una aplicaci贸n ejecutable utilizando Kotlin y Gradle. Al igual que en las
secciones anteriores, inicialmente nos conformaremos con una configuraci贸n simple para comprender los conceptos b谩sicos
e iremos mejorando la aplicaci贸n en las secciones siguientes.

## Echo App

La aplicaci贸n que crearemos se llama **Echo App**. Su funci贸n es simple: recibir un mensaje como argumento y mostrarlo
en la consola junto a la hora actual. Aunque la funcionalidad es b谩sica, nos permitir谩 explorar c贸mo configurar un
proyecto Gradle y ejecutar una aplicaci贸n Kotlin.

### Dependencias en detalle

Para expandir las funcionalidades de nuestro proyecto, vamos a a帽adir la biblioteca `kotlinx-datetime`, la cual nos
permitir谩 trabajar con fechas y horas en Kotlin de manera eficiente. El primer paso ser谩 actualizar el archivo
`libs.versions.toml` ubicado en la carpeta `gradle` con la nueva dependencia:

```toml title="./gradle/libs.versions.toml"
[versions]
# ...
kotlinx-datetime = "0.6.1"

[libraries]
# ...
kotlinx-datetime = { module = "org.jetbrains.kotlinx:kotlinx-datetime", version.ref = "kotlinx-datetime" }
```

Ahora, para asegurarnos de que todo est茅 correctamente configurado y habilitar el autocompletado en el IDE, construye
el proyecto ejecutando el siguiente comando en tu terminal:

```bash
./gradlew build
```

Lo siguiente es decirle a Gradle d贸nde debe buscar la nueva dependencia. Para ello, actualiza el archivo
`settings.gradle.kts` en la ra铆z del proyecto para incluir el repositorio de MavenCentral:

<Tabs groupId={"gradle"}>
    <TabItem value="Kotlin DSL" label="Kotlin DSL">
        ```kotlin title="settings.gradle.kts"
        // ...
        dependencyResolutionManagement {    // Gesti贸n de resoluci贸n de dependencias
            @Suppress("UnstableApiUsage")   // Necesario para usar la API de resoluci贸n de dependencias
            repositories {
                mavenCentral()  // Repositorio Maven Central
            }
        }
    ```
    </TabItem>
    <TabItem value="Groovy DSL" label="Groovy DSL">
        ```groovy title="settings.gradle"
        // ...
        dependencyResolutionManagement {    // Gesti贸n de resoluci贸n de dependencias
            repositories {
                mavenCentral()  // Repositorio Maven Central
            }
        }
        ```
    </TabItem>
</Tabs>

Aqu铆, hemos a帽adido `mavenCentral()` al bloque `repositories` para que Gradle pueda buscar la dependencia en Maven Central. Esto a帽adir谩 el repositorio a todos los m贸dulos del proyecto.

A continuaci贸n, actualiza el archivo `build.gradle.kts` en el m贸dulo `app` para incluir la nueva dependencia en el
bloque `dependencies`. Este bloque es donde definimos las bibliotecas que se utilizar谩n en el proyecto. Aqu铆 tienes una
descripci贸n algunos de los diferentes tipos de dependencias que se pueden declarar:

- `implementation`: Dependencias que ser谩n incluidas en la compilaci贸n y el empaquetado de la aplicaci贸n.
- `testImplementation`: Dependencias utilizadas 煤nicamente para las pruebas.
- `runtimeOnly`: Dependencias necesarias solo en tiempo de ejecuci贸n, no durante la compilaci贸n.
- `testRuntimeOnly`: Dependencias necesarias solo en tiempo de ejecuci贸n de las pruebas.
- `compileOnly`: Dependencias utilizadas en tiempo de compilaci贸n, pero no incluidas en tiempo de ejecuci贸n.
- `testCompileOnly`: Dependencias para la compilaci贸n de las pruebas, no necesarias en tiempo de ejecuci贸n.
- `api`: Dependencias que se compilan y tambi茅n se exponen a otros m贸dulos.
- `testApi`: Dependencias para pruebas que se exponen a otros m贸dulos.

La sintaxis b谩sica para a帽adir una dependencia es la siguiente:

<Tabs groupId={"gradle"}>
    <TabItem value="Kotlin DSL" label="Kotlin DSL">
```kotlin
dependencies {
    implementation("group:artifact:version")
    implementation(group = "group", name = "artifact", version = "version")
    implementation(libs.artifact)
}
```
</TabItem>
<TabItem value="Groovy DSL" label="Groovy DSL">
```groovy
dependencies {
    implementation 'group:artifact:version'
    implementation group: 'group', name: 'artifact', version: 'version'
    implementation libs.artifact
}
```
</TabItem>
</Tabs>

En nuestro caso, a帽adimos la dependencia de `kotlinx-datetime` a nuestro proyecto de la siguiente manera:

<Tabs groupId={"gradle"}>
    <TabItem value="Kotlin DSL" label="Kotlin DSL">
```kotlin title="app/build.gradle.kts"
dependencies {
    implementation(libs.kotlinx.datetime)
}
```
</TabItem>
<TabItem value="Groovy DSL" label="Groovy DSL">
```groovy title="app/build.gradle"
dependencies {
    implementation libs.kotlinx.datetime
}
```
</TabItem>
</Tabs>

### Creando la aplicaci贸n

Una vez que las dependencias est谩n configuradas, es momento de empezar a escribir el c贸digo de nuestra aplicaci贸n. El
primer paso es crear un nuevo paquete utilizando el nombre del grupo del proyecto seguido de `.echo` (por ejemplo,
`cl.ravenhill.echo`). Dentro de este paquete, crearemos un archivo llamado `EchoApp.kt` que contendr谩 la l贸gica
principal de la aplicaci贸n.

El siguiente c贸digo muestra c贸mo construir nuestra aplicaci贸n:

```kotlin title="./app/src/main/kotlin/cl/ravenhill/echo/EchoApp.kt"
package cl.ravenhill.echo

import kotlinx.datetime.Clock

fun echo(message: String) = "${Clock.System.now()} - $message"

fun main(args: Array<String>) {
    for (arg in args) {
        println(echo(arg))
    }
}
```

En este ejemplo:
- Usamos `kotlinx.datetime.Clock` para obtener la hora actual y as铆 agregar una marca de tiempo a los mensajes que se
    env铆an como argumento.
- La funci贸n `echo()` toma un mensaje como par谩metro y devuelve una cadena con el mensaje acompa帽ado de la hora actual.
- En la funci贸n `main()`, se iteran los argumentos de la aplicaci贸n (`args`), y para cada uno de ellos, se llama a la
    funci贸n `echo()`.

#### Configuraci贸n del plugin `application`

Para que nuestra aplicaci贸n sea ejecutable con Gradle, necesitamos agregar el plugin `application` al archivo
`build.gradle.kts` en el m贸dulo `app`. Este plugin nos permitir谩 ejecutar la aplicaci贸n mediante el comando
`./gradlew :app:run` y empaquetarla con `./gradlew :app:installDist`.

A帽ade el siguiente bloque al archivo `build.gradle.kts`:

<Tabs>
    <TabItem value="Kotlin DSL" label="Kotlin DSL">
```kotlin title="./app/build.gradle.kts"
plugins {
    // ...
    application
}

// ...

application {
    mainClass.set("cl.ravenhill.echo.EchoAppKt")
}
```
</TabItem>
<TabItem value="Groovy DSL" label="Groovy DSL">
```groovy title="./app/build.gradle"
plugins {
    // ...
    id 'application'
}

// ...

application {
    mainClass.set('cl.ravenhill.echo.EchoAppKt')
}
```
</TabItem>
</Tabs>

En este bloque:
- Se aplica el plugin `application`.
- Definimos la clase principal que contiene la funci贸n `main()` de nuestra aplicaci贸n. En este caso, la clase generada
    por el compilador de Kotlin es `cl.ravenhill.echo.EchoAppKt`. El compilador agrega `Kt` al nombre de la clase, ya
    que es el nombre del archivo en el que est谩 definida la funci贸n `main()`.

#### Ejecutando la aplicaci贸n

Para ejecutar la aplicaci贸n, usa el siguiente comando en la terminal:

```bash
./gradlew :app:run --args "Hello, world!"
```

El resultado deber铆a ser similar al siguiente:

```text
> Task :app:run
2024-09-08T18:35:20.469735500Z - Hello,
2024-09-08T18:35:20.479782500Z - world!
```

En este punto, has creado una aplicaci贸n funcional que recibe argumentos y los imprime junto con una marca de tiempo.
Esto demuestra c贸mo integrar una biblioteca externa (`kotlinx-datetime`) y c贸mo configurar el proyecto para que sea
ejecutable con Gradle.

### El problema con `gradle run`

Aunque `gradle run` es una forma r谩pida y conveniente de ejecutar una aplicaci贸n Kotlin durante el desarrollo, presenta algunas limitaciones importantes:

- **No permite pasar argumentos directamente desde la l铆nea de comandos**: Para pasar argumentos, debemos usar `--args`, lo cual puede ser menos intuitivo.
- **No soporta input interactivo**: No se pueden recibir entradas directamente desde la consola mientras la aplicaci贸n est谩 en ejecuci贸n.
- **Requiere que Gradle est茅 instalado**: Cualquier persona que desee ejecutar la aplicaci贸n deber谩 tener Gradle instalado, lo cual no es ideal para distribuci贸n a usuarixs finales.

Por estas razones, `gradle run` es m谩s 煤til para el desarrollo, pero no es la mejor opci贸n cuando queremos distribuir nuestra aplicaci贸n a usuarixs finales. Para crear un archivo ejecutable independiente de Gradle, podemos utilizar el comando `gradle installDist`.

```bash
./gradlew :app:installDist
```

Este comando genera un directorio `build/install/app`, que contiene un script de inicio que permite ejecutar la aplicaci贸n sin necesidad de Gradle. Para ejecutar la aplicaci贸n empaquetada, solo debes ejecutar el siguiente comando:

```bash
./app/build/install/app/bin/app "Hello," "world!"
```

Esto producir谩 el mismo resultado que ejecutar `gradle run`, pero con la ventaja de que no depende de Gradle y puede distribuirse de manera m谩s sencilla.

### 隆Felicidades! 

Has creado tu primera aplicaci贸n ejecutable en Kotlin, lista para distribuirse sin la necesidad de Gradle. Este es un paso importante para asegurar que tu aplicaci贸n sea m谩s accesible para quienes la usen, ya que podr谩n ejecutarla de manera independiente.

## Lo que aprendimos

- C贸mo agregar dependencias a un proyecto Gradle.
- C贸mo configurar un proyecto Gradle para ejecutar una aplicaci贸n Kotlin.
- C贸mo ejecutar una aplicaci贸n Kotlin utilizando `gradle run`.
- C贸mo empaquetar una aplicaci贸n Kotlin en un archivo ejecutable para su distribuci贸n, usando `gradle installDist`.

<div className="language-card-container">
    <LanguageCard
        logoSrc="https://upload.wikimedia.org/wikipedia/commons/thumb/1/13/Cmake.svg/1200px-Cmake.svg.png"
        language="C/C++: CMake"
        link="cmake"
    />
    <LanguageCard
        logoSrc="https://static-00.iconduck.com/assets.00/file-type-maven-icon-192x256-wb8b12w6.png"
        language="JVM: Maven"
        link="maven"
    />
    <LanguageCard
        logoSrc="https://www.svgrepo.com/show/373479/buckbuild.svg"
        language="Multilenguaje: Buck"
        link="buck"
    />
</div>

<References references={[
    {
        accessedDate: '9 de septiembre de 2024',
        siteOrAuthor: 'Gradle',
        title: 'The Application Plugin',
        type: 'web',
        url: 'https://docs.gradle.org/current/userguide/application_plugin.html',
    },
]}/>
